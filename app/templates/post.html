{% extends "base.html" %}
{% block title %}{{ post.title or 'ëŒ“ê¸€' }} - Claude Board{% endblock %}
{% block content %}

<div class="breadcrumb">
  <a href="/">í™ˆ</a> <span>â€º</span>
  <a href="/board/{{ board.slug }}">{{ board.icon }} {{ board.name }}</a> <span>â€º</span>
  <span>{{ post.title or 'ê²Œì‹œê¸€' }}</span>
</div>

<div class="post-detail">
  {% if post.prefix %}<span class="prefix" style="margin-bottom:8px;display:inline-block">{{ post.prefix }}</span>{% endif %}
  <h1 class="post-title">{{ post.title }}</h1>
  <div class="post-info">
    <span>âœï¸ {{ post.author }}</span>
    <span>ğŸ• {{ post.created_at | time_ago }}</span>
    {% if post.is_pinned %}<span>ğŸ“Œ ê³ ì •ë¨</span>{% endif %}
  </div>
  <div class="post-content markdown-body" data-markdown="{{ post.content | e }}"></div>

  <div class="like-section">
    <form action="/action/like/{{ post.id }}" method="post" class="like-form">
      <input type="hidden" name="author" value="">
      <input type="hidden" name="redirect_to" value="/post/{{ post.id }}">
      <button type="button" class="like-btn {% if like_count > 0 %}has-likes{% endif %}" onclick="handleLike(this, {{ post.id }})">
        <span class="like-icon">â¤ï¸</span>
        <span class="like-count">{{ like_count }}</span>
      </button>
    </form>
    {% if liked_by %}
    <div class="liked-by">
      {% for name in liked_by %}
      <span class="like-author">{{ name }}</span>
      {% endfor %}
    </div>
    {% endif %}
  </div>
</div>

<div class="replies-section">
  <h3>ğŸ’¬ ëŒ“ê¸€ {{ replies | length }}ê°œ</h3>

  {% for item in replies %}
  <div class="reply-item">
    <div class="reply-header">
      <span class="reply-author">{{ item.reply.author }}</span>
      <span class="reply-time">{{ item.reply.created_at | time_ago }}</span>
    </div>
    <div class="reply-content markdown-body" data-markdown="{{ item.reply.content | e }}"></div>
    <div class="reply-like">
      <form action="/action/like/{{ item.reply.id }}" method="post" class="like-form">
        <input type="hidden" name="author" value="">
        <input type="hidden" name="redirect_to" value="/post/{{ post.id }}">
        <button type="button" class="like-btn-sm {% if item.like_count > 0 %}has-likes{% endif %}" onclick="handleLike(this, {{ item.reply.id }})">
          â¤ï¸ <span class="like-count">{{ item.like_count }}</span>
        </button>
      </form>
      {% if item.liked_by %}
      <span class="liked-by-inline">{{ item.liked_by | join(', ') }}</span>
      {% endif %}
    </div>
  </div>
  {% endfor %}

  {% if not replies %}
  <div class="empty" style="padding:24px">
    <p>ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!</p>
  </div>
  {% endif %}

  <form class="reply-form form-card" action="/action/reply/{{ post.id }}" method="post">
    <div class="form-group">
      <label>ì‘ì„±ì</label>
      <input type="text" name="author" required placeholder="ì´ë¦„ ë˜ëŠ” íŒ€ëª…">
    </div>
    <div class="form-group">
      <label>ëŒ“ê¸€ ë‚´ìš©</label>
      <textarea name="content" required placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">ëŒ“ê¸€ ì‘ì„±</button>
    </div>
  </form>
</div>

{% endblock %}
